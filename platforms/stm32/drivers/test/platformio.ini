; PlatformIO Project Configuration for STM32H743
; TriggEngine - 4" Display Build
;
; Build:   pio run
; Upload:  pio run -t upload
; Monitor: pio device monitor

[env:weact_h743]
platform = ststm32
board = genericSTM32H743VI
framework = stm32cube

; WeAct STM32H743VIT6 specific settings
board_build.mcu = stm32h743vit6
board_build.f_cpu = 480000000L

; Upload via ST-Link (SWD header on board)
upload_protocol = stlink
debug_tool = stlink

; Serial monitor
monitor_speed = 115200

; Build flags
build_flags =
    -D HSE_VALUE=25000000U          ; 25MHz external crystal on WeAct board
    -D USE_HAL_DRIVER
    -D STM32H743xx
    -D USE_FULL_LL_DRIVER           ; Enable LL drivers for performance
    -O2                             ; Optimization level
    -Wall
    -Wextra
    -std=c++11                      ; C++11 standard per project requirements

    ; Display configuration
    -D DISPLAY_WIDTH=480
    -D DISPLAY_HEIGHT=320

    ; Pin definitions (from wiring guide)
    -D LCD_CS_PIN=GPIO_PIN_11
    -D LCD_CS_PORT=GPIOE
    -D LCD_RST_PIN=GPIO_PIN_10
    -D LCD_RST_PORT=GPIOE
    -D LCD_DC_PIN=GPIO_PIN_9
    -D LCD_DC_PORT=GPIOE
    -D LCD_LED_PIN=GPIO_PIN_8
    -D LCD_LED_PORT=GPIOE

    -D CTP_RST_PIN=GPIO_PIN_7
    -D CTP_RST_PORT=GPIOE
    -D CTP_INT_PIN=GPIO_PIN_6
    -D CTP_INT_PORT=GPIOE

    -D SD_CS_PIN=GPIO_PIN_5
    -D SD_CS_PORT=GPIOE

; Library dependencies
lib_deps =

; Source filter - only compile STM32 specific files
src_filter =
    +<*>
    +<../drivers_stm32/*>
    +<../engine/graphics/*>
    +<../engine/isometric/*>
    +<../engine/math/*>

; Extra source directories
build_src_filter = +<*>

[env:weact_h743_debug]
extends = env:weact_h743
build_type = debug
build_flags =
    ${env:weact_h743.build_flags}
    -g3
    -O0
    -D DEBUG=1
